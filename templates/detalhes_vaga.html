{% extends "base.html" %}
{% block conteudo %}
<div class="card" style="max-width:800px;margin:auto;">
  <div class="linha-topo">
    <span class="badge {% if vaga.externa %}badge-azul{% else %}badge-verde{% endif %}">
      {% if vaga.externa %}Vaga Externa{% else %}Vaga Interna{% endif %}
    </span>
    {% if session.get('tipo') == 'estudante' %}
      <form method="POST" action="{{ url_for('favoritar', vaga_id=vaga.id) }}" class="form-star">
        {% if fav_ids and vaga.id in fav_ids %}
          <button class="star ativo" title="Remover dos favoritos">â˜…</button>
        {% else %}
          <button class="star" title="Guardar nos favoritos">â˜†</button>
        {% endif %}
      </form>
    {% endif %}
  </div>

  <h2>{{ vaga.titulo }}</h2>
  {% if vaga.categoria %}<p><b>Categoria:</b> {{ vaga.categoria }}</p>{% endif %}
  {% if vaga.cidade %}<p><b>Cidade:</b> {{ vaga.cidade }}</p>{% endif %}
  {% if vaga.horario %}<p><b>HorÃ¡rio:</b> {{ vaga.horario }}</p>{% endif %}
  {% if vaga.tipo %}<p><b>Tipo:</b> {{ vaga.tipo }}</p>{% endif %}
  <p style="margin-top:10px;"><b>DescriÃ§Ã£o:</b></p>
  <p>{{ vaga.descricao }}</p>

  {% if vaga.externa %}
    <p style="margin-top:15px;"><a class="btn btn-primario" href="{{ vaga.link_externo }}" target="_blank">Candidatar no site externo</a></p>
  {% else %}
    {% if session.get('tipo') == 'estudante' %}
      <hr style="margin:15px 0;">
      <h3>Candidatura</h3>
      {% if erro_upload %}<div class="alerta alerta-erro">{{ erro_upload }}</div>{% endif %}
      {% if sucesso %}<div class="alerta alerta-sucesso">Candidatura enviada com sucesso! ğŸ‰</div>{% endif %}
      <form method="POST" enctype="multipart/form-data">
        <label>Carregar CV (PDF/DOC/DOCX, mÃ¡x 2MB):</label>
        <input type="file" name="cv" accept=".pdf,.doc,.docx" required>
        <button class="btn btn-sucesso" type="submit">ğŸ“© Enviar candidatura</button>
      </form>
    {% else %}
      <p class="alerta alerta-erro">âš ï¸ Faz login como <b>estudante</b> para te candidatares.</p>
    {% endif %}
  {% endif %}
  <p style="margin-top:15px;"><a href="{{ url_for('pagina_vagas') }}">â¬… Voltar</a></p>
</div>
{% endblock %}
